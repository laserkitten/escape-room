<!-- This page can be found at https://laserkitten.github.io/escape-room -->
<html>
  <head>
    <title>The Present by @laserkitten</title>
  	<link href="css/laserkitten.css" rel="stylesheet" type="text/css">
  </head>
  <script>
    var pic_state;
    var pic_decoy;
    var liquid;
    var wood;
    var jar_1;
    var jar_2;
    var jar_3;
    var jar_4;
    var jar_5;
    var jar_6;
    var jar_7;
    var jar_8;
    var jar_9;
    var jar_10;
    var jar_11;
    var jar_12;
    var jar_13;
    function initialize() {
      const url_params = new URLSearchParams(window.location.search);
      if (url_params.has('status')) {
        var status = url_params.get('status');
        var i  = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'].indexOf(status[0]);
        pic_state = i%4;
        pic_decoy = Math.floor(i/4);
        i      = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'].indexOf(status[1]);
        liquid = i%4;
        wood   = ((Math.floor(i/4)-2*Math.floor(i/8))>0);
        jar_1  = (Math.floor(i/8)>0);
        i      = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'].indexOf(status[2]);
        var s  = i.toString(2) + '000';
        jar_2  = (s[0]=='1');
        jar_3  = (s[1]=='1');
        jar_4  = (s[2]=='1');
        jar_5  = (s[3]=='1');
        i      = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'].indexOf(status[3]);
        s      = i.toString(2) + '000';
        jar_6  = (s[0]=='1');
        jar_7  = (s[1]=='1');
        jar_8  = (s[2]=='1');
        jar_9  = (s[3]=='1');
        i      = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'].indexOf(status[4]);
        s      = i.toString(2) + '000';
        jar_10 = (s[0]=='1');
        jar_11 = (s[1]=='1');
        jar_12 = (s[2]=='1');
        jar_13 = (s[3]=='1');
        if (liquid == 1) {
          document.getElementById('button_0').value = 'Taste the liquid.';
          document.getElementById('text').innerHTML = 'You look closely at the reddish liquid. There is no distinct smell and it\'s highly viscous.';}
        else if (liquid == 2) {
          liquid = liquid + 1;
          document.getElementById('button_0').type = 'hidden';
          document.getElementById('text').innerHTML = 'It\'s beet syrup.';}
        else if (liquid == 3) {
          document.getElementById('button_0').type = 'hidden';
          document.getElementById('text').innerHTML = 'You look closer at the metal stove. Someone has written the numbers 6, 22, and 12 onto the rusty surface using beet syrup. Why on earth did you think it was blood?';}}
      else {
        window.location.href = 'present_stove.html?status=00000';}}
    function inspect() {
      liquid = liquid + 1;
      var status = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][pic_state];
      var i = liquid;
      if (wood) {
      i = i + 4;}
      if (jar_1) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_2) {
      i = 1;}
      else {
      i = 0;}
      if (jar_3) {
      i = i + 2;}
      if (jar_4) {
      i = i + 4;}
      if (jar_5) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_6) {
      i = 1;}
      else {
      i = 0;}
      if (jar_7) {
      i = i + 2;}
      if (jar_8) {
      i = i + 4;}
      if (jar_9) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_10) {
      i = 1;}
      else {
      i = 0;}
      if (jar_11) {
      i = i + 2;}
      if (jar_12) {
      i = i + 4;}
      if (jar_13) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      window.location.href = 'present_stove.html?status=' + status;}
    function leave() {
      if (liquid%4 == 1) {
        liquid = liquid - 1;}
      else if (liquid%4 == 2) {
        liquid = liquid + 1;}
        var status = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][pic_state];
        var i = liquid;
        if (wood) {
        i = i + 4;}
        if (jar_1) {
        i = i + 8;}
        status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
        if (jar_2) {
        i = 1;}
        else {
        i = 0;}
        if (jar_3) {
        i = i + 2;}
        if (jar_4) {
        i = i + 4;}
        if (jar_5) {
        i = i + 8;}
        status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
        if (jar_6) {
        i = 1;}
        else {
        i = 0;}
        if (jar_7) {
        i = i + 2;}
        if (jar_8) {
        i = i + 4;}
        if (jar_9) {
        i = i + 8;}
        status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
        if (jar_10) {
        i = 1;}
        else {
        i = 0;}
        if (jar_11) {
        i = i + 2;}
        if (jar_12) {
        i = i + 4;}
        if (jar_13) {
        i = i + 8;}
        status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
        window.location.href = 'present.html?status=' + status;}
  </script>
  <body onload='initialize();'>
    <div class='content'>
      <p class='title'>The Present, an Online Escape Room</p>
      <svg width='640' height='360'>
        <image xlink:href='img/stove.jpg' />
        <path id='arrow' onclick='leave();' d='M 313.00,334.00 C 313.00,334.00 309.00,334.00 309.00,334.00 309.00,334.00 318.00,347.00 318.00,347.00 318.00,347.00 320.00,347.00 320.00,347.00 320.00,347.00 329.00,334.00 329.00,334.00 329.00,334.00 324.00,334.00 324.00,334.00 324.00,334.00 324.00,317.00 324.00,317.00 321.72,317.00 316.34,316.64 314.60,318.02 312.12,319.98 313.00,330.71 313.00,334.00 Z' />
      </svg>
      <p id='text'>You look closer at the metal stove. Someone has written the numbers 6, 22, and 12 onto the rusty surface using a thick reddish liquid. Could it be blood?</p>
      <input class='button' id='button_0' type='button' value='Inspect the liquid.' onclick='inspect();'>
    </div>
  </body>
</html>
