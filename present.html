<!-- This page can be found at https://laserkitten.github.io/escape-room -->
<html>
  <head>
    <title>The Present by @laserkitten</title>
  	 <link href="css/laserkitten.css" rel="stylesheet" type="text/css">
  </head>
  <script>
    var pic_state;
    var pic_decoy;
    var liquid;
    var wood;
    var jar_1;
    var jar_2;
    var jar_3;
    var jar_4;
    var jar_5;
    var jar_6;
    var jar_7;
    var jar_8;
    var jar_9;
    var jar_10;
    var jar_11;
    var jar_12;
    var jar_13;
    function initialize() {
      const url_params = new URLSearchParams(window.location.search);
      if (url_params.has('status')) {
        var status = url_params.get('status');
        var i  = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'].indexOf(status[0]);
        pic_state = i%4;
        pic_decoy = Math.floor(i/4);
        i      = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'].indexOf(status[1]);
        liquid = i%4;
        wood   = ((Math.floor(i/4)-2*Math.floor(i/8))>0);
        jar_1  = (Math.floor(i/8)>0);
        i      = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'].indexOf(status[2]);
        var s  = i.toString(2) + '000';
        jar_2  = (s[0]=='1');
        jar_3  = (s[1]=='1');
        jar_4  = (s[2]=='1');
        jar_5  = (s[3]=='1');
        i      = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'].indexOf(status[3]);
        s      = i.toString(2) + '000';
        jar_6  = (s[0]=='1');
        jar_7  = (s[1]=='1');
        jar_8  = (s[2]=='1');
        jar_9  = (s[3]=='1');
        i      = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'].indexOf(status[4]);
        s      = i.toString(2) + '000';
        jar_10 = (s[0]=='1');
        jar_11 = (s[1]=='1');
        jar_12 = (s[2]=='1');
        jar_13 = (s[3]=='1');
        if (wood) {
          document.getElementById('furnace_small').onclick = function() {furnace_locked()};
          document.getElementById('furnace_big').onclick = function() {furnace_8()};}}
      else {
        window.location.href = 'present.html?status=00000';}}
    function leave_left() {
      var status = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][pic_state];
      var i = liquid;
      if (wood) {
      i = i + 4;}
      if (jar_1) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_2) {
      i = 1;}
      else {
      i = 0;}
      if (jar_3) {
      i = i + 2;}
      if (jar_4) {
      i = i + 4;}
      if (jar_5) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_6) {
      i = 1;}
      else {
      i = 0;}
      if (jar_7) {
      i = i + 2;}
      if (jar_8) {
      i = i + 4;}
      if (jar_9) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_10) {
      i = 1;}
      else {
      i = 0;}
      if (jar_11) {
      i = i + 2;}
      if (jar_12) {
      i = i + 4;}
      if (jar_13) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      window.location.href = 'present_shelf.html?status=' + status;}
    function leave_stove() {
      var status = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][pic_state];
      var i = liquid;
      if (wood) {
      i = i + 4;}
      if (jar_1) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_2) {
      i = 1;}
      else {
      i = 0;}
      if (jar_3) {
      i = i + 2;}
      if (jar_4) {
      i = i + 4;}
      if (jar_5) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_6) {
      i = 1;}
      else {
      i = 0;}
      if (jar_7) {
      i = i + 2;}
      if (jar_8) {
      i = i + 4;}
      if (jar_9) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_10) {
      i = 1;}
      else {
      i = 0;}
      if (jar_11) {
      i = i + 2;}
      if (jar_12) {
      i = i + 4;}
      if (jar_13) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      window.location.href = 'present_stove.html?status=' + status;}
    function leave_winery() {
      var status = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][pic_state];
      var i = liquid;
      if (wood) {
      i = i + 4;}
      if (jar_1) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_2) {
      i = 1;}
      else {
      i = 0;}
      if (jar_3) {
      i = i + 2;}
      if (jar_4) {
      i = i + 4;}
      if (jar_5) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_6) {
      i = 1;}
      else {
      i = 0;}
      if (jar_7) {
      i = i + 2;}
      if (jar_8) {
      i = i + 4;}
      if (jar_9) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      if (jar_10) {
      i = 1;}
      else {
      i = 0;}
      if (jar_11) {
      i = i + 2;}
      if (jar_12) {
      i = i + 4;}
      if (jar_13) {
      i = i + 8;}
      status = status + ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'][i];
      window.location.href = 'present_winery.html?status=' + status;}
    function tools() {
      document.getElementById('button_0').type = 'hidden';
      document.getElementById('text').innerHTML = 'Dusty cooking utensils are hanging next to the stove. You really hope that your uncle cleans them before use.';}
    function label() {
      document.getElementById('button_0').type = 'hidden';
      document.getElementById('text').innerHTML = 'The sign reads \'Have you tried opening the furnace?\'';}
    function cleaner() {
      document.getElementById('button_0').type = 'hidden';
      document.getElementById('text').innerHTML = 'A can with stove cleaner.';}
    function logs() {
      document.getElementById('button_0').type = 'hidden';
      document.getElementById('text').innerHTML = 'Someone marked the logs with the same liquid that covers the stove. There are nine logs labelled 1-9.';}
    function solve() {
      document.getElementById('button_0').type = 'hidden';
      var test = document.getElementById('1').checked;
      test = test && document.getElementById('2').checked;
      test = test && !document.getElementById('3').checked;
      test = test && !document.getElementById('4').checked;
      test = test && !document.getElementById('5').checked;
      test = test && document.getElementById('6').checked;
      test = test && !document.getElementById('7').checked;
      test = test && !document.getElementById('8').checked;
      test = test && !document.getElementById('9').checked;
      if (test) {
        wood = true;
        document.getElementById('furnace_small').onclick = function() {furnace_locked()};
        document.getElementById('furnace_big').onclick = function() {furnace_8()};
        document.getElementById('text').innerHTML = 'You hear a clicking sound from the furnace to your right.';}
      else {
        document.getElementById('text').innerHTML = 'Nothing happens.';}}
    function furnace_riddle() {
      document.getElementById('button_0').type = 'button';
      document.getElementById('button_0').value = 'Close the hatch.';
      document.getElementById('button_0').onclick = function() {solve()};
      document.getElementById('text').innerHTML = 'The hatch under the stove opens readily. There is space for firewood. Maybe the numbered logs from below can be placed inside? Which logs do you want to place in the fireplace?<br><br><input type=\'checkbox\' value=\'1\' name=\'1\' id=\'1\'><label for=\'1\'> log #1</label><br><input type=\'checkbox\' value=\'2\' name=\'2\' id=\'2\'><label for=\'2\'> log #2</label><br><input type=\'checkbox\' value=\'3\' name=\'3\' id=\'3\'><label for=\'3\'> log #3</label><br><input type=\'checkbox\' value=\'4\' name=\'4\' id=\'4\'><label for=\'4\'> log #4</label><br><input type=\'checkbox\' value=\'5\' name=\'5\' id=\'5\'><label for=\'5\'> log #5</label><br><input type=\'checkbox\' value=\'6\' name=\'6\' id=\'6\'><label for=\'6\'> log #6</label><br><input type=\'checkbox\' value=\'7\' name=\'7\' id=\'7\'><label for=\'7\'> log #7</label><br><input type=\'checkbox\' value=\'8\' name=\'8\' id=\'8\'><label for=\'8\'> log #8</label><br><input type=\'checkbox\' value=\'9\' name=\'9\' id=\'9\'><label for=\'9\'> log #9</label>';}
    function furnace_locked() {
      document.getElementById('button_0').type = 'hidden';
      document.getElementById('text').innerHTML = 'The hatch does not open anymore. Your work here is done.';}
    function hint() {
      document.getElementById('button_0').type = 'hidden';
      document.getElementById('text').innerHTML = '<span onclick=\'reveal();\'style=\'cursor: pointer;\'>Click here to reveal a hint:</span><br><br><span id=\'hint\' style=\'background-color: #cdb48c;\'>The code on the stove can be used to open the furnace and it will help you understand its content.</span>';}
    function reveal() {
      document.getElementById('hint').style.backgroundColor = 'black';}
    function furnace_0() {
      document.getElementById('button_0').type = 'button';
      document.getElementById('button_0').value = 'Open the furnace.';
      document.getElementById('button_0').onclick = function() {furnace_1()};
      document.getElementById('text').innerHTML = 'An old furnace with a rusty door.';}
    function furnace_1() {
      document.getElementById('button_0').type = 'button';
      document.getElementById('button_0').value = 'Knock on the door.';
      document.getElementById('button_0').onclick = function() {furnace_2()};
      document.getElementById('text').innerHTML = 'The door doesn\'t open. It is locked from the inside.';}
    function furnace_2() {
      document.getElementById('button_0').type = 'button';
      document.getElementById('button_0').value = 'Say \'Open sesame!\'';
      document.getElementById('button_0').onclick = function() {furnace_3()};
      document.getElementById('text').innerHTML = 'The sound echoes through the basement, but the door remains locked.';}
    function furnace_3() {
      document.getElementById('button_0').type = 'button';
      document.getElementById('button_0').value = 'Pretend to be the police.';
      document.getElementById('button_0').onclick = function() {furnace_4()};
      document.getElementById('text').innerHTML = 'You feel a little silly, but you are committed to opening this door. You say the magic words, but this door does not adhere to the rules.';}
    function furnace_4() {
      document.getElementById('button_0').type = 'button';
      document.getElementById('button_0').value = 'Pretend to have a warrant.';
      document.getElementById('button_0').onclick = function() {furnace_5()};
      document.getElementById('text').innerHTML = 'You knock again and say that the content of this furnace is pretinent to an ongoing investigation. The door knows its rights and refuses to open.';}
    function furnace_5() {
      document.getElementById('button_0').type = 'button';
      document.getElementById('button_0').value = 'Curse at the door.';
      document.getElementById('button_0').onclick = function() {furnace_6()};
      document.getElementById('text').innerHTML = 'The door calls your bluff.';}
    function furnace_6() {
      document.getElementById('button_0').type = 'button';
      document.getElementById('button_0').value = 'You have bested me door.';
      document.getElementById('button_0').onclick = function() {furnace_7()};
      document.getElementById('text').innerHTML = 'Your curses echo through the basement, but the door is above that.';}
    function furnace_7() {
      document.getElementById('button_0').type = 'hidden';
      document.getElementById('text').innerHTML = 'The door knows.';}
    function furnace_8() {
      document.getElementById('button_0').type = 'button';
      document.getElementById('button_0').value = 'Open the furnace.';
      document.getElementById('button_0').onclick = function() {furnace_9()};
      document.getElementById('text').innerHTML = 'An old furnace with a rusty door.';}
    function furnace_9() {
      document.getElementById('button_0').type = 'hidden';
      document.getElementById('text').innerHTML = 'You brace for yet another disappointment, but the door opens this time. Inside the furnace you find a piece of paper:<br><br>Who am I?<br><br>(a) I am rumored to come from Ethiopia.<br>(e) I can be red and green, but cooked I always am green.<br>(i) I have been likened to hands.<br>(o) I can be rather spicy.<br>(u) I grow on trees.<br><br>Only three of these hints are true!';}
  </script>
  <body onload='initialize();'>
    <div class='content'>
      <p class='title'>The Present, an Online Escape Room</p>
      <svg width='640' height='423'>
        <image xlink:href='img/main.jpg' />
        <image xlink:href='img/hint_logo.png' style='cursor: pointer;' onclick='hint();' />
        <path id='tools' onclick='tools();' d='M 126.00,47.00 C 126.00,47.00 126.00,128.00 126.00,128.00 126.00,128.00 225.00,128.00 225.00,128.00 225.00,128.00 225.00,47.00 225.00,47.00 225.00,47.00 126.00,47.00 126.00,47.00 Z' />
        <path id='cleaner' onclick='cleaner();' d='M 277.00,150.00 C 277.00,150.00 277.00,181.00 277.00,181.00 277.00,181.00 287.00,181.00 287.00,181.00 287.00,181.00 287.00,150.00 287.00,150.00 287.00,150.00 277.00,150.00 277.00,150.00 Z' />
        <path id='label' onclick='label();' d='M 458.00,68.00 C 458.00,68.00 458.00,94.00 458.00,94.00 458.00,94.00 475.00,94.00 475.00,94.00 475.00,94.00 475.00,68.00 475.00,68.00 475.00,68.00 458.00,68.00 458.00,68.00 Z' />
        <path id='furnace_big' onclick='furnace_0();' d='M 452.00,262.00 C 452.00,262.00 485.00,257.00 485.00,257.00 485.00,257.00 487.00,192.00 487.00,192.00 487.00,192.00 482.00,151.00 482.00,151.00 478.36,150.49 468.16,147.41 465.41,149.06 463.43,150.26 462.24,153.90 461.40,156.00 461.40,156.00 455.40,171.00 455.40,171.00 455.40,171.00 452.53,179.00 452.53,179.00 452.53,179.00 452.00,206.00 452.00,206.00 452.00,206.00 452.00,262.00 452.00,262.00 Z' />
        <path id='furnace_small' onclick='furnace_riddle();' d='M 279.00,291.00 C 279.00,291.00 279.00,206.00 279.00,206.00 279.00,206.00 261.00,206.00 261.00,206.00 255.69,206.10 249.66,208.67 247.60,214.04 246.75,216.25 247.00,222.37 247.03,225.00 247.03,225.00 247.03,246.00 247.03,246.00 247.03,246.00 247.03,274.00 247.03,274.00 246.99,276.25 246.62,281.14 247.03,283.00 247.93,285.90 252.49,292.25 255.30,293.43 258.84,294.91 274.32,291.62 279.00,291.00 Z' />
        <path id='wood' onclick='logs();' d='M 253.00,412.00 C 253.00,412.00 274.00,404.68 274.00,404.68 274.00,404.68 319.00,387.42 319.00,387.42 319.00,387.42 335.00,381.20 335.00,381.20 335.00,381.20 341.90,377.49 341.90,377.49 341.90,377.49 341.90,369.00 341.90,369.00 341.90,369.00 339.00,349.00 339.00,349.00 335.02,348.47 326.28,347.74 323.32,345.42 319.82,342.65 316.33,334.43 312.68,331.93 310.29,330.30 295.33,328.24 292.00,328.27 288.03,328.32 285.18,330.56 282.00,332.67 269.97,340.63 272.15,338.38 266.72,351.00 262.63,360.50 254.12,377.21 254.00,387.00 254.00,387.00 253.00,412.00 253.00,412.00 Z' />
        <path id='arrow_back' onclick='leave_winery();' d='M 603.00,203.00 C 603.00,203.00 594.00,215.00 594.00,215.00 594.00,215.00 599.00,216.00 599.00,216.00 599.00,216.00 599.00,232.00 599.00,232.00 599.00,232.00 610.00,232.00 610.00,232.00 610.00,232.00 610.00,216.00 610.00,216.00 610.00,216.00 614.00,216.00 614.00,216.00 612.44,210.69 607.91,205.52 603.00,203.00 Z' />
        <path id='arrow_left' onclick='leave_left();' d='M 27.00,303.00 C 27.00,303.00 27.00,298.00 27.00,298.00 27.00,298.00 43.00,298.00 43.00,298.00 43.00,298.00 43.00,287.00 43.00,287.00 43.00,287.00 27.00,287.00 27.00,287.00 27.00,287.00 27.00,283.00 27.00,283.00 23.78,284.10 15.20,289.12 15.20,293.00 15.20,296.68 23.92,301.79 27.00,303.00 Z' />
        <path id='arrow_stove' onclick='leave_stove();' d='M 211.00,175.00 C 207.26,179.07 203.57,182.61 202.00,188.00 202.00,188.00 206.00,188.00 206.00,188.00 206.00,188.00 206.00,204.00 206.00,204.00 206.00,204.00 217.00,204.00 217.00,204.00 217.00,204.00 217.00,188.00 217.00,188.00 217.00,188.00 222.00,187.00 222.00,187.00 222.00,187.00 211.00,175.00 211.00,175.00 Z' />
      </svg>
      <p id='text'>You stand in the kitchen of your uncle's basement. This is where he pickles the produce that is stored in a shelf to your left. There is also a wine cellar further in the back.</p>
      <input class='button' id='button_0' type='hidden'>
    </div>
  </body>
</html>
